<ng-container *ngIf="!loading && meal">
    <div class="meal-summary-header">
        <div class="meal-info-row">
            <span class="meal-name">{{ meal.type }}</span>
            <span class="meal-date">{{ mealDate | displayDate }}</span>
        </div>
        <div class="nutrients-totals-row">
            <div>
                <div class="macro-label">Calories</div>
                <div class="macro-value calories">{{ totalCalories | smartNumber }} <span>kcal</span></div>
            </div>
            <div>
                <div class="macro-label">Proteins</div>
                <div class="macro-value proteins">{{ totalProteins| smartNumber }} <span>g</span></div>
            </div>
            <div>
                <div class="macro-label">Carbs</div>
                <div class="macro-value carbs">{{ totalCarbs| smartNumber }} <span>g</span></div>
            </div>
            <div>
                <div class="macro-label">Fats</div>
                <div class="macro-value fats">{{ totalFats| smartNumber }} <span>g</span></div>
            </div>
        </div>
    </div>

    <!-- Nova sekcija s gumbima -->
    <div class="meal-action-buttons">
        <button class="meal-action-btn" (click)="scanBarcode()">
            <img src="../../../../assets/media/barcode_scanner_plavi.svg" alt="">
            <span>Scan Barcode</span>
        </button>

        <button class="meal-action-btn" (click)="logFood()">
           <img src="../../../../assets/media/menu_book_plavi.svg" alt="">
            <span>Log Food</span>
        </button>
    </div>

    <div class="meal-food-list">
        <ion-list>
            <ion-item lines="full" *ngFor="let item of meal.items; let i = index">
                <ion-label class="food-label">
                    <div class="food-title">{{ item.name }}</div>


                    <div class="food-details">
                        <!-- 2x2 grid: gore 2, dolje 2 -->
                        <div class="food-macros-grid">
                            <div class="macro"><span>Calories(kcal)</span><strong>{{ item.calories }}</strong></div>
                            <div class="macro"><span>Proteins(g)</span><strong>{{ item.proteins }}</strong></div>
                            <div class="macro"><span>Carbs(g)</span><strong>{{ item.carbs }}</strong></div>
                            <div class="macro"><span>Fats(g)</span><strong>{{ item.fats }}</strong></div>
                        </div>

                        <button class="qty-chip" slot="end" (click)="openFoodDetails(i)">
                            {{ item.default_quantity }}{{ item.unit }}
                        </button>

                    </div>
                </ion-label>

                <!-- klik na količinu otvara food-details -->

            </ion-item>
        </ion-list>

    </div>
</ng-container>